{%- style -%}
  
  .badges-grid { display:grid; grid-template-columns:repeat(6,1fr); gap:24px; text-align:center; }
  .badge-item { display:flex; flex-direction:column; align-items:center; gap:12px; }
  .badge-icon { width:64px; height:64px; display:flex; align-items:center; justify-content:center; }
  .badge-icon svg { width:100%; height:100%; color:#1a9d5e; stroke:#1a9d5e; fill:none; }
  .badge-label { font-weight:700; font-size:13px; color:#111; line-height:1.3; }
  
  @media (max-width:900px) {
    .badges-grid { grid-template-columns:repeat(3,1fr); gap:16px; }
    .badge-icon { width:48px; height:48px; }
    .badge-label { font-size:12px; }
  }
  
  @media (max-width:600px) {
    .badges-grid { grid-template-columns:repeat(2,1fr); gap:12px; }
  }

  /* Featured Products Slider Styles */
  .featured-products-slider {
    width: 100%;
    background: #f9f9f9;
    padding: 40px 20px;
    border-top: 1px solid #eee;
  }

  .fps-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .fps-header {
    margin-bottom: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .fps-heading {
    font-size: 28px;
    font-weight: 700;
    margin: 0;
    color: #333;
  }

  .fps-subtext {
    font-size: 14px;
    color: #666;
    margin: 5px 0 0 0;
  }

  .fps-tabs {
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
    border-bottom: 2px solid #eee;
  }

  .fps-tab {
    background: none;
    border: none;
    font-size: 16px;
    font-weight: 500;
    color: #999;
    padding: 10px 0;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.3s ease;
  }

  .fps-tab--active {
    color: #333;
    border-bottom-color: #333;
  }

  .fps-slider-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 20px;
  }

  .fps-slider-container {
    flex: 1;
    overflow: hidden;
  }

  .fps-slider {
    display: flex;
    gap: 20px;
    position: relative;
  }

  .fps-track {
    display: flex;
    gap: 20px;
    width: 100%;
  }

  .fps-item {
    flex-shrink: 0;
    width: calc(16.666% - 17px);
  }

  .fps-card {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
    overflow: hidden;
    transition: all 0.3s ease;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .fps-card:hover {
    border-color: #ddd;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .fps-image {
    width: 100%;
    aspect-ratio: 1;
    overflow: hidden;
    background: #f5f5f5;
  }

  .fps-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .fps-card:hover .fps-image img {
    transform: scale(1.05);
  }

  .fps-content {
    padding: 15px;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .fps-product-name {
    font-size: 14px;
    font-weight: 600;
    margin: 0 0 10px 0;
    color: #333;
    line-height: 1.3;
    flex: 1;
  }

  .fps-price {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 10px;
  }

  .fps-price--original {
    font-size: 12px;
    color: #999;
    text-decoration: line-through;
  }

  .fps-price--current {
    font-size: 16px;
    font-weight: 700;
    color: #d32f2f;
  }

  .fps-btn {
    display: inline-block;
    background: #333;
    color: #fff;
    padding: 8px 16px;
    border-radius: 4px;
    text-decoration: none;
    font-size: 12px;
    font-weight: 600;
    text-align: center;
    transition: all 0.3s ease;
    border: 1px solid #333;
  }

  .fps-btn:hover {
    background: #fff;
    color: #333;
  }

  .fps-arrow {
    background: #333;
    color: #fff;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    transition: all 0.3s ease;
    flex-shrink: 0;
  }

  .fps-arrow:hover {
    background: #555;
    transform: scale(1.1);
  }

  .fps-dots {
    display: flex;
    justify-content: center;
    gap: 8px;
  }

  .fps-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #ddd;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .fps-dot.active {
    background: #333;
    transform: scale(1.2);
  }

  .fps-no-products {
    padding: 40px 20px;
    text-align: center;
    color: #999;
    font-size: 14px;
  }

  /* Responsive Design */
  @media (max-width: 1200px) {
    .fps-item {
      width: calc(25% - 15px);
    }
  }

  @media (max-width: 992px) {
    .fps-item {
      width: calc(33.333% - 14px);
    }
  }

  @media (max-width: 768px) {
    .fps-item {
      width: calc(50% - 10px);
    }
    .fps-heading {
      font-size: 22px;
    }
    .featured-products-slider {
      padding: 30px 15px;
    }
  }

  @media (max-width: 480px) {
    .fps-item {
      width: 100%;
    }
    .fps-heading {
      font-size: 18px;
    }
    .fps-tabs {
      gap: 10px;
    }
    .fps-tab {
      font-size: 14px;
    }
  }
{%- endstyle -%}


  <div class="badges-grid">
    <div class="badge-item">
      <div class="badge-icon">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <!-- ISO Certified: circular badge with ISO text -->
          <circle cx="32" cy="32" r="24" stroke="#1a9d5e" stroke-width="2" fill="none"/>
          <circle cx="32" cy="32" r="20" stroke="#1a9d5e" stroke-width="1.5" fill="none"/>
          <circle cx="32" cy="32" r="16" stroke="#1a9d5e" stroke-width="1" fill="none"/>
          <text x="32" y="37" text-anchor="middle" font-size="10" font-weight="bold" fill="#1a9d5e">ISO</text>
        </svg>
      </div>
      <span class="badge-label">ISO Certified</span>
    </div>

    <div class="badge-item">
      <div class="badge-icon">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <!-- Eco-Friendly: hands holding plant -->
          <path d="M20 40 Q20 30 28 24 Q36 30 36 40" stroke="#1a9d5e" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M24 40 L24 48 M32 40 L32 48 M20 48 L36 48" stroke="#1a9d5e" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M18 32 Q16 28 14 24 M46 32 Q48 28 50 24" stroke="#1a9d5e" stroke-width="1.5" fill="none" stroke-linecap="round"/>
        </svg>
      </div>
      <span class="badge-label">Eco-Friendly</span>
    </div>

    <div class="badge-item">
      <div class="badge-icon">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <!-- Herbal Solution: mortar and pestle with leaves -->
          <path d="M24 20 L28 16 L32 14 L36 16 L40 20" stroke="#1a9d5e" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M26 22 L28 18 L32 16 L36 18 L38 22" stroke="#1a9d5e" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M28 28 Q24 32 20 38 Q32 46 44 38 Q40 32 36 28" stroke="#1a9d5e" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M32 28 L32 42" stroke="#1a9d5e" stroke-width="1.5" fill="none"/>
        </svg>
      </div>
      <span class="badge-label">Herbal Solution</span>
    </div>

    <div class="badge-item">
      <div class="badge-icon">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
          <!-- Made with Love: star with heart inside -->
          <path d="M32 16 L38 28 L50 28 L40 36 L44 48 L32 40 L20 48 L24 36 L14 28 L26 28 Z" stroke="#1a9d5e" stroke-width="2" fill="none" stroke-linejoin="round"/>
          <path d="M26 40 Q28 44 32 42 Q36 44 38 40" stroke="#1a9d5e" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <span class="badge-label">Made with Love</span>
    </div>

    <div class="badge-item">
      <div class="badge-icon">
        <img
          src="//www.osheaherbals.com/cdn/shop/files/Mask_group_e5604e0f-2733-4ef5-956d-2d1f3f43f130.png?v=1763461744&width=120"
          alt="15 Years of Trust"
          loading="lazy"
          width="56"
          height="56"
          style="width:56px;height:56px;object-fit:contain;display:block;"
        >
      </div>
      <span class="badge-label">15 Years of Trust</span>
    </div>

    <div class="badge-item">
      <div class="badge-icon">
        <img
          src="//www.osheaherbals.com/cdn/shop/files/Mask_group_1_136c0031-aa9f-44fe-8f1f-754c6c469777.png?v=1763461743&width=120"
          alt="Dermat Tested"
          loading="lazy"
          width="56"
          height="56"
          style="width:56px;height:56px;object-fit:contain;display:block;"
        >
      </div>
      <span class="badge-label">Dermat Tested</span>
    </div>
  </div>
</section>

<!-- Featured Products Slider Section -->
<div class="featured-products-slider" id="featured-products-slider-{{ section.id }}">
  <div class="fps-container">
    <div class="fps-header">
      <div>
        <h2 class="fps-heading">{{ section.settings.heading }}</h2>
        {% if section.settings.subtext %}
          <p class="fps-subtext">{{ section.settings.subtext }}</p>
        {% endif %}
      </div>
    </div>

    <!-- Tabs -->
    <div class="fps-tabs">
      <button class="fps-tab fps-tab--active" data-target="new">New Arrivals</button>
      <button class="fps-tab" data-target="best">Best Sellers</button>
    </div>

    <!-- Slider Container -->
    <div class="fps-slider-wrapper">
      <button class="fps-arrow fps-arrow--left" aria-label="Previous">❮</button>
      
      <div class="fps-slider-container">
        <div class="fps-slider" data-items-per-view="6">
          <!-- New Arrivals -->
          <div class="fps-track" data-tab="new">
            {% assign new_collection = section.settings.new_collection %}
            {% if new_collection %}
              {% liquid
                if new_collection == 'all'
                  assign products = shop.products | sort: 'created_at' | reverse | limit: section.settings.product_limit
                else
                  assign collection = collections[new_collection]
                  assign products = collection.products | limit: section.settings.product_limit
                endif
              %}
              {% if products.size > 0 %}
                {% for product in products %}
                  <div class="fps-item">
                    <div class="fps-card">
                      <div class="fps-image">
                        {% if product.featured_image %}
                          <img src="{{ product.featured_image | img_url: '500x' }}" alt="{{ product.featured_image.alt }}" loading="lazy" />
                        {% endif %}
                      </div>
                      <div class="fps-content">
                        <h3 class="fps-product-name">{{ product.title }}</h3>
                        <div class="fps-price">
                          {% if product.compare_at_price > product.price %}
                            <span class="fps-price--original">{{ product.compare_at_price | money }}</span>
                          {% endif %}
                          <span class="fps-price--current">{{ product.price | money }}</span>
                        </div>
                        <a href="{{ product.url }}" class="fps-btn">View</a>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <div class="fps-no-products">No products found in the selected collection.</div>
              {% endif %}
            {% endif %}
          </div>

          <!-- Best Sellers -->
          <div class="fps-track" data-tab="best" style="display: none;">
            {% assign best_collection = section.settings.best_collection %}
            {% if best_collection %}
              {% liquid
                if best_collection == 'all'
                  assign products = shop.products | limit: section.settings.product_limit
                else
                  assign collection = collections[best_collection]
                  assign products = collection.products | limit: section.settings.product_limit
                endif
              %}
              {% if products.size > 0 %}
                {% for product in products %}
                  <div class="fps-item">
                    <div class="fps-card">
                      <div class="fps-image">
                        {% if product.featured_image %}
                          <img src="{{ product.featured_image | img_url: '500x' }}" alt="{{ product.featured_image.alt }}" loading="lazy" />
                        {% endif %}
                      </div>
                      <div class="fps-content">
                        <h3 class="fps-product-name">{{ product.title }}</h3>
                        <div class="fps-price">
                          {% if product.compare_at_price > product.price %}
                            <span class="fps-price--original">{{ product.compare_at_price | money }}</span>
                          {% endif %}
                          <span class="fps-price--current">{{ product.price | money }}</span>
                        </div>
                        <a href="{{ product.url }}" class="fps-btn">View</a>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <div class="fps-no-products">No products found in the selected collection.</div>
              {% endif %}
            {% endif %}
          </div>
        </div>
      </div>

      <button class="fps-arrow fps-arrow--right" aria-label="Next">❯</button>
    </div>

    <!-- Dots Indicator -->
    <div class="fps-dots"></div>
  </div>
</div>

{% schema %}
{
  "name": "Trust Badges & Products",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Featured Products Heading",
      "default": "Featured Products"
    },
    {
      "type": "textarea",
      "id": "subtext",
      "label": "Featured Products Subtext",
      "default": "Discover our newest launches and all-time bestsellers, curated just for you."
    },
    {
      "type": "collection",
      "id": "new_collection",
      "label": "New Arrivals Collection"
    },
    {
      "type": "collection",
      "id": "best_collection",
      "label": "Best Sellers Collection"
    },
    {
      "type": "number",
      "id": "product_limit",
      "label": "Product limit per tab",
      "default": 12
    }
  ],
  "presets": [ { "name": "Trust Badges with Featured Products" } ]
}
{% endschema %}

<script>
  (function() {
    var sliderContainer = document.getElementById('featured-products-slider-{{ section.id }}');
    if (!sliderContainer) return;

    var tabs = sliderContainer.querySelectorAll('.fps-tab');
    var tracks = sliderContainer.querySelectorAll('.fps-track');
    var leftArrow = sliderContainer.querySelector('.fps-arrow--left');
    var rightArrow = sliderContainer.querySelector('.fps-arrow--right');
    var slider = sliderContainer.querySelector('.fps-slider');
    var dotsContainer = sliderContainer.querySelector('.fps-dots');

    var currentTab = 'new';
    var currentPosition = 0;
    var itemsPerView = 6;

    function updateItemsPerView() {
      var width = window.innerWidth;
      if (width >= 1200) itemsPerView = 6;
      else if (width >= 992) itemsPerView = 4;
      else if (width >= 768) itemsPerView = 3;
      else if (width >= 480) itemsPerView = 2;
      else itemsPerView = 1;
      slider.dataset.itemsPerView = itemsPerView;
    }

    function switchTab(tabName) {
      currentTab = tabName;
      currentPosition = 0;
      tabs.forEach(function(tab) {
        tab.classList.toggle('fps-tab--active', tab.dataset.target === tabName);
      });
      tracks.forEach(function(track) {
        track.style.display = track.dataset.tab === tabName ? 'flex' : 'none';
      });
      updateDots();
      moveSlider();
    }

    function getVisibleItems() {
      var activeTrack = sliderContainer.querySelector('[data-tab="' + currentTab + '"]');
      if (!activeTrack) return [];
      return Array.from(activeTrack.querySelectorAll('.fps-item'));
    }

    function moveSlider() {
      var activeTrack = sliderContainer.querySelector('[data-tab="' + currentTab + '"]');
      if (!activeTrack) return;
      var items = getVisibleItems();
      var itemWidth = items.length > 0 ? (activeTrack.offsetWidth / itemsPerView) : 0;
      activeTrack.style.transform = 'translateX(' + (-currentPosition * itemWidth) + 'px)';
    }

    function updateDots() {
      dotsContainer.innerHTML = '';
      var items = getVisibleItems();
      var maxScroll = Math.max(0, items.length - itemsPerView);
      for (var i = 0; i <= maxScroll; i++) {
        var dot = document.createElement('div');
        dot.className = 'fps-dot' + (i === currentPosition ? ' active' : '');
        dot.onclick = function(idx) {
          return function() { currentPosition = idx; moveSlider(); updateDots(); };
        }(i);
        dotsContainer.appendChild(dot);
      }
    }

    function slideLeft() {
      var items = getVisibleItems();
      var maxScroll = Math.max(0, items.length - itemsPerView);
      currentPosition = Math.max(0, currentPosition - 1);
      moveSlider();
      updateDots();
    }

    function slideRight() {
      var items = getVisibleItems();
      var maxScroll = Math.max(0, items.length - itemsPerView);
      currentPosition = Math.min(maxScroll, currentPosition + 1);
      moveSlider();
      updateDots();
    }

    tabs.forEach(function(tab) {
      tab.addEventListener('click', function() {
        switchTab(tab.dataset.target);
      });
    });

    leftArrow.addEventListener('click', slideLeft);
    rightArrow.addEventListener('click', slideRight);

    window.addEventListener('resize', function() {
      updateItemsPerView();
      moveSlider();
      updateDots();
    });

    // Initialize
    updateItemsPerView();
    updateDots();
    moveSlider();
  })();
</script>
